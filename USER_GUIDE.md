# User Guide - AI Reporting Agents

## Table of Contents
1. [Introduction](#introduction)
2. [Getting Started](#getting-started)
3. [Finance AI Agent](#finance-ai-agent)
4. [Marketing AI Agent](#marketing-ai-agent)
5. [Understanding Reports](#understanding-reports)
6. [Customization](#customization)
7. [Troubleshooting](#troubleshooting)

## Introduction

The AI Reporting Agents automate the generation of finance and marketing reports by:
- Connecting to your Zoho account
- Extracting relevant data
- Analyzing trends and anomalies
- Creating visualizations
- Delivering insights via email and Slack

## Getting Started

### Prerequisites

Before using the AI Reporting Agents, ensure you have:

1. **Zoho Account** with:
   - Zoho Books (for Finance data)
   - Zoho CRM/Marketing Hub (for Marketing data)

2. **Access Credentials**:
   - API credentials for this system
   - Zoho API access configured

3. **Communication Channels**:
   - Email address for receiving reports
   - Slack workspace access (optional)

### First Time Setup

1. **Verify Configuration**
   - Contact your system administrator to ensure Zoho integration is configured
   - Confirm your email/Slack channels are set up

2. **Test Manual Report Generation**
   - Use the API or web interface to generate a test report
   - Verify you receive the report via your configured channels

## Finance AI Agent

### What It Does

The Finance AI Agent automatically:
- Collects financial data from Zoho Books
- Calculates key metrics (revenue, expenses, cash flow)
- Identifies overdue invoices
- Analyzes top clients
- Detects financial anomalies
- Generates AI-powered insights

### Weekly Finance Reports

**Schedule**: Default Monday at 9:00 AM

**Contents**:
- 7-day financial summary
- Revenue breakdown
- Expense analysis
- Cash flow status
- Overdue invoice alerts
- Top 10 clients by revenue
- AI-generated insights and recommendations

**Example Use Cases**:
- Monday morning executive briefing
- Quick weekly financial health check
- Cash flow monitoring
- Client relationship management

### Monthly Finance Reports

**Schedule**: Default 1st of each month at 9:00 AM

**Contents**:
- Full month financial analysis
- Month-over-month comparisons
- Detailed revenue trends
- Expense category breakdown
- Client performance analysis
- Financial health assessment
- Strategic recommendations

**Example Use Cases**:
- Board meeting preparation
- Monthly financial reviews
- Budget vs. actual analysis
- Strategic planning

### Reading Finance Reports

#### Key Metrics Explained

1. **Revenue**
   - Total income from paid invoices
   - Indicates business performance
   - Compare to previous periods for trends

2. **Expenses**
   - Total expenditures from bills
   - Monitor for cost control
   - Categorized for detailed analysis

3. **Cash Flow**
   - Net difference between revenue and expenses
   - Positive = healthy, Negative = review needed
   - Critical for business sustainability

4. **Overdue Invoices**
   - Count and total value of unpaid invoices
   - High numbers indicate collection issues
   - Actionable for accounts receivable team

#### Understanding AI Insights

The AI analyzes your data and provides:

- **Verdict**: Overall assessment (On Track / Mixed / Off Track)
- **Highlights**: What's going well
- **Concerns**: Issues requiring attention
- **Recommendations**: Actionable next steps

Example AI Insight:
```
Overall Verdict: Mixed Performance

• Revenue up 15% vs. target - strong sales in Q4
• Expenses exceeded budget by 8% due to hiring
• Cash flow positive at $45,000
• 12 overdue invoices totaling $23,500 require immediate attention

Recommendations:
- Accelerate collection on overdue invoices
- Review expense categories for optimization
- Maintain current sales momentum
```

## Marketing AI Agent

### What It Does

The Marketing AI Agent automatically:
- Collects marketing data from Zoho CRM/Marketing Hub
- Tracks lead generation and conversions
- Analyzes campaign performance
- Monitors advertising spend and ROI
- Evaluates channel effectiveness
- Provides marketing insights

### Weekly Marketing Reports

**Schedule**: Default Monday at 10:00 AM

**Contents**:
- 7-day marketing summary
- Leads generated by source
- Campaign performance
- Ad spend analysis
- CTR and engagement metrics
- Top performing campaigns
- AI-driven optimization suggestions

**Example Use Cases**:
- Weekly marketing team sync
- Campaign performance review
- Quick wins identification
- Budget reallocation decisions

### Monthly Marketing Reports

**Schedule**: Default 1st of each month at 10:00 AM

**Contents**:
- Full month marketing analysis
- Lead generation trends
- Channel performance comparison
- ROI by campaign
- Traffic and engagement growth
- Conversion funnel analysis
- Strategic marketing recommendations

**Example Use Cases**:
- Monthly marketing review meetings
- Budget planning
- Campaign strategy refinement
- Stakeholder reporting

### Reading Marketing Reports

#### Key Metrics Explained

1. **Leads Generated**
   - Total new leads acquired
   - Broken down by source/channel
   - Indicator of top-of-funnel health

2. **Ad Spend**
   - Total marketing investment
   - Compare to budget
   - Track efficiency over time

3. **CTR (Click-Through Rate)**
   - Percentage of people who clicked ads
   - Higher = better ad relevance
   - Benchmark: 2-5% is typical

4. **ROI (Return on Investment)**
   - Revenue generated vs. cost
   - Positive ROI = profitable campaigns
   - Use to prioritize channels

5. **Traffic Growth**
   - Website visitor increase
   - Indicates brand awareness
   - Correlate with campaigns

6. **Engagement Rate**
   - How actively users interact
   - Higher = better content quality
   - Key for social media success

#### Channel Performance

Reports break down performance by channel:
- **Organic Search**: SEO effectiveness
- **Paid Ads**: PPC campaign results
- **Social Media**: Social channel performance
- **Email**: Email marketing success
- **Referral**: Partnership effectiveness

#### Understanding Campaign Data

Each campaign shows:
- **Clicks**: Interest level
- **Conversions**: Actual results
- **Spend**: Investment amount
- **ROI**: Profitability

Use this to:
- Identify winning campaigns
- Pause underperforming campaigns
- Reallocate budget to top performers

## Understanding Reports

### Report Delivery

Reports are delivered via:

1. **Email**
   - Rich HTML format
   - Includes key metrics and tables
   - Visualizations as attachments
   - Suitable for forwarding

2. **Slack**
   - Concise summary format
   - Posted to designated channels
   - Quick team visibility
   - Easy discussion starter

### Visualizations

Reports include interactive charts:

1. **Finance Visualizations**
   - Revenue vs. Expenses bar chart
   - Top clients ranking
   - Revenue trend line
   - Expense category pie chart

2. **Marketing Visualizations**
   - Marketing overview indicators
   - Campaign performance comparison
   - Channel effectiveness bars
   - CTR and engagement gauges

### Accessing Historical Reports

Use the API to retrieve past reports:

```bash
# List recent finance reports
GET /api/v1/finance/reports?limit=10

# Get specific report
GET /api/v1/finance/reports/{report_id}
```

Or use the web dashboard (if configured).

## Customization

### Adjusting Report Schedules

Contact your administrator to modify:
- Report frequency
- Delivery times
- Recipients
- Channels

Example custom schedules:
- Bi-weekly reports
- End-of-quarter special reports
- Different teams receive different reports

### Custom Recipients

Set up different recipients for different report types:
- Finance team: finance reports only
- Marketing team: marketing reports only
- Executives: both reports, summary format

### Delivery Preferences

Choose your preferred delivery method:
- Email only
- Slack only
- Both email and Slack
- API access for custom integration

## Troubleshooting

### Not Receiving Reports

**Check**:
1. Verify your email/Slack settings
2. Check spam folder (for email)
3. Confirm scheduled jobs are running: `GET /scheduled-jobs`
4. Review delivery logs in database

**Solutions**:
- Update email/Slack preferences
- Whitelist sender email
- Contact administrator to check scheduler

### Report Data Looks Incorrect

**Common Causes**:
1. Zoho data not up-to-date
2. Date range misconfiguration
3. Missing permissions in Zoho

**Solutions**:
- Refresh data in Zoho
- Verify date ranges in report
- Check Zoho API permissions
- Review sync logs: Check `zoho_sync_logs` table

### AI Insights Not Appearing

**Causes**:
- OpenAI API key not configured
- API quota exceeded
- Network connectivity issues

**Solutions**:
- Fallback summaries will be used
- Contact administrator to verify OpenAI setup
- Reports still contain all data, just not AI analysis

### Missing Visualizations

**Causes**:
- Visualization service error
- File storage issues
- Empty data sets

**Solutions**:
- Check application logs
- Verify storage permissions
- Ensure data exists for period

## Best Practices

### For Finance Teams

1. **Review Weekly Reports**
   - Monday morning routine
   - Quick health check
   - Identify collection needs

2. **Deep Dive Monthly**
   - Block time for analysis
   - Compare to budgets
   - Strategic planning

3. **Act on Insights**
   - Follow AI recommendations
   - Track improvements
   - Iterate on strategies

### For Marketing Teams

1. **Monitor Weekly Performance**
   - Check campaign results
   - Optimize underperformers
   - Scale winners

2. **Monthly Strategy Review**
   - Assess channel mix
   - ROI-based decisions
   - Plan next month's campaigns

3. **Data-Driven Decisions**
   - Use metrics to guide strategy
   - Test and iterate
   - Document learnings

### For Executives

1. **Dashboard Review**
   - Quick scan of key metrics
   - Identify trends
   - Spot issues early

2. **Use for Decision Making**
   - Budget allocation
   - Resource planning
   - Strategic priorities

3. **Share Insights**
   - Forward to stakeholders
   - Use in presentations
   - Track progress over time

## Getting Help

### Support Channels

- **Technical Issues**: support@yourcompany.com
- **Feature Requests**: product@yourcompany.com
- **Documentation**: See README.md

### Additional Resources

- API Documentation: http://localhost:8000/docs
- Zoho API Docs: https://www.zoho.com/books/api/v3/
- OpenAI Best Practices: https://platform.openai.com/docs

## Frequently Asked Questions

**Q: Can I generate reports on-demand?**
A: Yes, use the API endpoints or contact your administrator.

**Q: Can I customize what metrics are included?**
A: Contact your administrator for custom configurations.

**Q: How far back can I access historical reports?**
A: All reports are stored in the database indefinitely.

**Q: Can I export reports to PDF?**
A: Currently reports are HTML/JSON format. PDF export is on the roadmap.

**Q: What if I need a report for a custom date range?**
A: This feature is planned for a future release.

**Q: Can I integrate these reports with other tools?**
A: Yes, use the API to integrate with your tools.

## Feedback

We value your feedback! Please share:
- Feature requests
- Bug reports
- Usability improvements
- Success stories

Contact: feedback@yourcompany.com
